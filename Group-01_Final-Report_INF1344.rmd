---
title: "Final Report - Group 01"
author: "Amie Leung, Ivan Nguyen, Janna Cameron, Kaye Ann Caroningan, and Syed Hassan"
date: "Nov 29, 2025"
output:
  pdf_document:
    toc: true
    toc_depth: '3'
    latex_engine: xelatex
date-format: D MM YY
abstract: This report analyzes the relationship between Human Development Index (HDI)
  and broadband access across various countries, highlighting trends and insights
  from the data. Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas
  lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit
  nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim
  tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor.
  Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS AT THE END
bibliography: references.bib
subtitle: "HDI and Broadband - Data Analysis"
---

# 1. Motivation {#sec-motivation}

Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in.

Sed eget luctus tellus. Vestibulum dui orci, commodo a tincidunt sed, aliquet sed elit. Aenean mauris dolor, luctus sed sapien ut, pellentesque ornare nibh. Phasellus velit mauris, interdum eu massa id, pretium condimentum nisi. Sed at pellentesque mi. Vivamus id justo non elit lacinia efficitur. Sed commodo vehicula nisi, a tristique lectus cursus at. Nullam finibus elementum justo, a molestie augue iaculis sit amet. Praesent quis ante sit amet arcu condimentum commodo quis eu lectus. Curabitur pellentesque mattis enim, eu elementum lectus sollicitudin pellentesque. CHANGE THIS OF COURSE

# 2. Review of Similar Research {#sec-similar-research}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in.

Sed eget luctus tellus. Vestibulum dui orci, commodo a tincidunt sed, aliquet sed elit. Aenean mauris dolor, luctus sed sapien ut, pellentesque ornare nibh. Phasellus velit mauris, interdum eu massa id, pretium condimentum nisi. Sed at pellentesque mi. Vivamus id justo non elit lacinia efficitur. Sed commodo vehicula nisi, a tristique lectus cursus at. Nullam finibus elementum justo, a molestie augue iaculis sit amet. Praesent quis ante sit amet arcu condimentum commodo quis eu lectus. Curabitur pellentesque mattis enim, eu elementum lectus sollicitudin pellentesque. CHANGE THIS OF COURSE

# 3. Research Questions {#section-research-questions}
## 3.1. Question 1
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE

## 3.2. Question 2
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE

## 3.3. Question 3
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE
# 4. Data {#sec-data}
```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(tidy=TRUE, tidy.opts=list(width.cutoff=20))
library(tidyverse)
library(janitor)
library(broom)
library(car)
library(lmtest)
library(dplyr)
library(infer)
library(corrplot)
library(kableExtra)
library(skimr)
```

We are using three files from the Gapminder dataset: \
HDI, Broadband, and GDP. [@dataset]

## 4.1 Loading the files
```{r echo=TRUE, results='hide', message=FALSE, warning=FALSE}
hdi <- read.csv("data/hdi_human_development_index.csv")
broadband <- read.csv("data/broadband_subscribers_per_100_people.csv")
gdp <- read.csv("data/gdp_pcap.csv")

```

## 4.2. Data Structure
In this section we will clean the header names of each dataset and explore and describe the datasets one by one. 

**1. Human Development Index (HDI):**
Based on data from the United Nations Development Programme website, this dataset contains the HDI scores for each country between the years 1990 and 2023. There are 193 rows and 35 columns. The data contains some missing values for certain periods.

Let's explore the shape of the dataset.

*Rows x Columns*

```{r echo=FALSE, message=FALSE, warning=FALSE}
dim(hdi)
```
Since there are 35 columns, let's only see the first and last five columns to see more detail of column names (after cleaning).

```{r echo=FALSE, message=FALSE, warning=FALSE}
hdi <- clean_names(hdi) 
head(colnames(hdi), 5)
tail(colnames(hdi), 5)
```
The year range of this dataset is 1990 - 2023. We can also see that the column names have "x" characters that need to be cleaned further.  
\
**2. Broadband subscribers (per 100 people):**
This dataset contains the number of fixed broadband subscriptions per 100 people between the years 1998 and 2023. Included in this measurement are all wired connections that provide high-speed internet access (>= 256 kbits/s), covering both residential and organizational subscriptions but excluding mobile-cellular networks. There are 193 rows and 28 columns. The data contains some missing values, mainly concentrated in the earlier years. 

*Rows x Columns*
```{r echo=FALSE, message=FALSE, warning=FALSE}
dim(broadband)
```
And the first and last five column names:
```{r echo=FALSE, message=FALSE, warning=FALSE}
broadband <- clean_names(broadband) 
head(colnames(broadband), 5)
tail(colnames(broadband), 5)
```
The year range of this dataset is 1998 - 2023. Again, the column names have "x"s that aren't helpful. Several columns have chr data type, which we will need to clean up. \ 
 \

**3. Gross Domestic Product (GDP):**
Adjusted for inflation and cost-of-living differences, this dataset measures the value of goods and services produced per person for each country, compiling data from the early 19th century to the present year. There are 194 rows and 303 columns.

*Rows x Columns*
```{r echo=FALSE, message=FALSE, warning=FALSE}
dim(gdp)
```
And the first and last five column names:
```{r echo=FALSE, message=FALSE, warning=FALSE}
gdp <- clean_names(gdp) 
head(colnames(gdp), 5)
tail(colnames(gdp), 5)
```

This dataset has the most number of years ranging from 1800 - 2100. The future year values might be predicted or empty which we can analyze further when standardizing and cleaning rows. The *geo* column is also interesting as after standardizing the country names, and merging the datasets, we can also map the data if needed. 

Please note: all datasets were sourced from the Gapminder repository. Data from the year 2022 coincides with the tail end of the COVID-19 pandemic; however, for the purposes of this report, we will not account for its potential impacts on GDP and HDI, particularly with regard to health.

## 4.3. Selecting the required columns

Since the dataset has values from 100+ years, we will narrow them down to the most recent decade starting from 2010 to 2023. Will also clean the years by removing the 'x' character before we select the columns of interest ("X2010" -> 2010).

**HDI**
```{r echo=FALSE, message=FALSE, warning=FALSE}
hdi <- hdi %>%
  rename_with(~ gsub("^x", "", .), -1) %>%
  select(country, `2011`:`2023`) %>%
  mutate(across(`2011`:`2023`, as.numeric))

head(hdi, 3)
```
Need to talk about the values. WHAT DO THE VALUES MEAN

**Broadband**
```{r echo=FALSE, message=FALSE, warning=FALSE}
broadband <- broadband %>%
  rename_with(~ gsub("^x", "", .), -1) %>%
  select(country, `2011`:`2023`)  %>%
  mutate(across(`2011`:`2023`, as.numeric))

head(broadband, 3)
```
Need to talk about the values. WHAT DO THE VALUES MEAN

**GDP**
```{r echo=FALSE, message=FALSE, warning=FALSE}
gdp <- gdp %>%
  rename(country = name) %>%
  rename_with(~ gsub("^x", "", .), -2) %>%
  select(country, `2011`:`2023`)  %>%
  mutate(across(`2011`:`2023`, as.numeric))

head(gdp, 3)
```
Need to talk about the values. WHAT DO THE VALUES MEAN


## 4.4. Standardizing country names - rows
Since the datasets might have countries that are not listed in the others, we need to make sure that we standardize all the country names to match one of the datasets as our source. We will take the HDI dataset as our source, and compare the names, and check for the difference in rows/country names. If we find any difference, we will make sure to either match those rows to the source dataset country names, and also remove territories and records that are not common amongst all.  
```{r echo=FALSE, message=FALSE, warning=FALSE}
missing_in_hdi_from_broadband <- setdiff(unique(broadband$country), unique(hdi$country))
missing_in_hdi_from_gdp <- setdiff(unique(gdp$country), unique(hdi$country))

print("Number of rows in HDI, Broadband, and GDP datasets:")
cat("HDI: ", nrow(hdi), ", Broadband: ", nrow(broadband), ", GDP: ", nrow(gdp))

print("Countries in Broadband but NOT in HDI:")
print(missing_in_hdi_from_broadband)

print("Countries in GDP but NOT in HDI:")
print(missing_in_hdi_from_gdp)
```
We can see some diffences in countries within each dataset. We will now standardized and filter the data to only focus on countries that are common amongst all three datasets. \newline 

**After standardizing:**
```{r echo=FALSE, message=FALSE, warning=FALSE}
common_countries <- Reduce(intersect, list(hdi$country, broadband$country, gdp$country))

hdi <- hdi %>% filter(country %in% common_countries)
broadband <- broadband %>% filter(country %in% common_countries)
gdp <- gdp %>% filter(country %in% common_countries)

cat("Number of rows in HDI dataset:", nrow(hdi), "\n")
cat("Number of rows in Broadband dataset:", nrow(broadband), "\n")
cat("Number of rows in GDP dataset:", nrow(gdp), "\n")
```

Now let's check for duplicates.

## 4.5. Handling duplicates (if any):
```{r echo=FALSE, message=FALSE, warning=FALSE}
remove_duplicates <- function(data) {
  original_rows <- nrow(data)
  data_noDuplicates <- data %>%
    distinct()
  new_rows <- nrow(data_noDuplicates)
  
  rows_removed <- original_rows - new_rows
  print_statement <- paste(rows_removed, "rows removed.")
  cat(print_statement)
  return(data_noDuplicates)
}

hdi <- remove_duplicates(hdi)
broadband <- remove_duplicates(broadband)
gdp <- remove_duplicates(gdp)
```
Now that we have standardized names, and checked for duplicates, let's explore the missing values.

## 4.6. Handling missing values - rows
```{r echo=FALSE, message=FALSE, warning=FALSE}
hdi_missing_values <- hdi %>%
    summarise(across(everything(), ~sum(is.na(.))))
print("Empty values in HDI")
list_transpose(as.list((hdi_missing_values)))

broadband_missing_values <- broadband %>%
    summarise(across(everything(), ~sum(is.na(.))))
print("Empty values in Broadband")
list_transpose(as.list((broadband_missing_values)))

gdp_missing_values <- gdp %>%
    summarise(across(everything(), ~sum(is.na(.))))
print("Empty values in GDP")
list_transpose(as.list((gdp_missing_values)))

```

Not dropping any at this point

```{r echo=FALSE, message=FALSE, warning=FALSE}
hdi_clean <- hdi
  # %>% drop_na()
broadband_clean <- broadband
  # %>% drop_na
gdp_clean <- gdp
  # %>% drop_na
```


# 5. Methodology {#sec-methodology}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE


## 5.2. Data Distribution
### 5.2.1. Distribution of HDI
#SYED: Can we show the 2011 and 2022 values only?
```{r echo=FALSE, message=FALSE, warning=FALSE, results=TRUE}
hdi_numeric <- hdi_clean %>%
  select(where(is.numeric))

hdi_long <- hdi_numeric %>%
  pivot_longer(
    cols = everything(),      
    names_to = "variable",    
    values_to = "value" 
  )

hdi_long %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ variable, scales = "free", ncol = 4) +
  theme_bw()

skim(hdi_clean)
```

Comment on the distribution

### 5.2.2. Distribution of Broadband
#SYED: Can we show the 2011 and 2022 values only?
```{r echo=FALSE, message=FALSE, warning=FALSE, results=TRUE}
broadband_numeric <- broadband_clean %>%
  select(where(is.numeric))

broadband_long <- broadband_numeric %>%
  pivot_longer(
    cols = everything(),      
    names_to = "variable",    
    values_to = "value" 
  )

broadband_long %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ variable, scales = "free", ncol = 4) +
  theme_bw()

skim(broadband_clean)
```

Comment on the distribution

### 5.2.3. Distribution of GDP
#SYED: Can we show the 2011 and 2022 values only?
```{r echo=FALSE, message=FALSE, warning=FALSE, results=TRUE}
gdp_numeric <- gdp_clean %>%
  select(where(is.numeric))

gdp_long <- gdp_numeric %>%
  pivot_longer(
    cols = everything(),      
    names_to = "variable",    
    values_to = "value" 
  )

gdp_long %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ variable, scales = "free", ncol = 4) +
  theme_bw()

skim(gdp_clean)
```

Comment on the distribution

### 5.2.4. Reshape the data
```{r echo=FALSE, message=FALSE, warning=FALSE}
hdi_long <- hdi_clean %>%
  pivot_longer(cols=-country, names_to="year", values_to="hdi") %>%
  mutate(year=as.numeric(year))

broadband_long <- broadband_clean %>%
  pivot_longer(cols=-country, names_to="year", values_to="broadband") %>%
  mutate(year=as.numeric(year))

gdp_long <- gdp_clean %>%
  pivot_longer(cols=-country, names_to="year", values_to="gdp") %>%
  mutate(year=as.numeric(year))
```

### Merge the data
```{r echo=FALSE, message=FALSE, warning=FALSE}
#Join the HDI & Broadband data by year and country
merged_data <- merge(broadband_long, hdi_long, by = c("country","year"))

#Join the GDP dataset
merged_data <- merge(merged_data, gdp_long, by = c("country", "year"))

#remove the missing values
merged_data <- na.omit(merged_data)
```

### Skewness
Although the original data spanned multiple years, this analysis focuses only on 2011 and 2022. We chose the former column as this coincides with the year that the UN declared internet access a basic human right (United Nations Human Rights Council, 2011). Although 2023 is the most recent year in our dataset, we decided to use 2022 because this year had the fewest missing values. More than 10% of the values for broadband subscriptions in 2023 (49/193) were missing.
```{r echo=FALSE, message=FALSE, warning=FALSE}
#Pull the data for 2022 only
data_2022 <- merged_data %>% filter(year==2022)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
#Pull the data for 2011 only
data_2011 <- merged_data %>% filter(year==2011)
```

Before modelling, we conducted an exploratory data analysis on the 2011 and 2022 distributions of HDI, broadband subscriptions, and GDP using histograms and boxplots to assess skewness and normality.

#### Distribution of Human Development Index (2022)

The 2022 HDI histogram and boxplot below indicate a mild left skew. However, because the skewness is not substantial, we chose not to transform the data.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Test the skewness and distribution of the data
#Histogram of HDI in 2022. Histogram show that the HDI of 2022 is mildy left skewed
ggplot(data_2022,aes(x=hdi))+
  geom_histogram(colour="white", fill="steelblue") +
  labs(title="Human Development Indices (HDI) in 2022",
       x = "HDI",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# Box plot of HDI in 2022
ggplot(data_2022, aes(y=hdi)) + 
  geom_boxplot() + 
  labs(title = "Human Development Indices (HDI) in 2022",
       y="Count") +
theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

#### Distribution of Human Development Index (2011)

The 2011 HDI histogram and boxplot also show a mild left skew. Similar to the 2022 HDI data, the skewness is not substantial, therefore we chose not to transform the data.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Test the skewness and distribution of the data
#Histogram of HDI in 2011. 
ggplot(data_2011,aes(x=hdi))+
  geom_histogram(colour="white", fill="steelblue") +
  labs(title="Human Development Indices (HDI) in 2011",
       x = "HDI",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# Box plot of HDI in 2011
ggplot(data_2011, aes(y=hdi)) + 
  geom_boxplot() + 
  labs(title = "Human Development Indices (HDI) in 2011",
       y="Count") +
  theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

#### Distribution of Broadband (2022)

The 2022 broadband subscription histogram and boxplot show a strong right skew, indicating the need to transform this variable before running the linear regression model.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Histogram of broadband in 2022. 
ggplot(data_2022,aes(x=broadband))+
  geom_histogram(colour="white", fill="steelblue") +
  labs(title="Distribution of Broadband in 2022",
       x = "Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# Box plot of broadband in 2022
ggplot(data_2022, aes(y=broadband)) + 
  geom_boxplot() + 
  labs(title = "Box plot of Broadband in 2022",
       y="Count") +
  theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

#### Distribution of Broadband (2011)

The 2011 broadband subscription data is also strongly right skewed based on the histogram and boxplot below. Therefore, we also need to transform this variable before including them in our model.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Histogram of broadband in 2011. 
ggplot(data_2022,aes(x=broadband))+
  geom_histogram(colour="white", fill="steelblue") +
  labs(title="Distribution of Broadband in 2011",
       x = "Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# Box plot of broadband in 2011
ggplot(data_2011, aes(y=broadband)) + 
  geom_boxplot() + 
  labs(title = "Box plot of Broadband in 2011",
       y="Count") +
  theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

##### Option 1: Log Transform

To address the severe right skew in the 2022 broadband subscription values, we applied a log transformation. First, all countries with a broadband value of zero were removed, as the logarithm of zero is undefined. We then created a new column, log_broadband, by taking the natural log of the broadband subscription values in the data set.

After the transformation, we visualized the distribution of log_broadband using a histogram and Quantile - Quantile (Q-Q) plot to assess whether the skewness had improved. However, the histogram and Q-Q plot indicate that the log transformation did not adequately normalize the data.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#log transformed the broadband
data_2022 <- data_2022 %>%
  filter(broadband != 0) %>% #remove all countries with 0 in their broadband subscription out of the dataset, because we can't take a log of it
  mutate(log_broadband = log(broadband))

#Testing the skewness of log transform broadband values
ggplot(data_2022,aes(x=log_broadband))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Log Tranformed Broadband in 2022",
       x = "Log Transformed Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

shapiro.test(data_2022$log_broadband)

qqnorm(data_2022$log_broadband, main = "Q-Q Plot for log transformed broadband", xlab = "Theoretical Quantiles", ylab = "log transformed broadband")

# Add a reference line
qqline(data_2022$log_broadband, col = "steelblue", lwd = 2)
```
The histogram shows that the log-transformed broadband values in 2022 is left-skewed. Furthermore, the S-shaped curve on the Q-Q plot provides further evidence that the log transformed data do not appear to have a normal distribution.

##### Option 2: Square root Transform

Because the log transformation did not sufficiently improve normality, we then consider a square root transformation instead. We created another column, sqrt_broadband, by taking the square root of the broadband subscription values in the 2022 dataset. After that, we created the histogram and Q-Q plot to visualize the distribution, which show a noticeable improvement in symmetry compared to both the original and log-transformed values
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Square root transform of the broadband dataset. 
data_2022 <- data_2022 %>%
  mutate(sqrt_broadband = sqrt(broadband))

#Testing the skewness of log transform broadband values
ggplot(data_2022,aes(x=sqrt_broadband))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Square rootTranformed Broadband in 2022",
       x = "Square root Transformed Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

shapiro.test(data_2022$sqrt_broadband)

qqnorm(data_2022$sqrt_broadband, main = "Q-Q Plot for Square root transformed broadband", xlab = "Theoretical Quantiles", ylab = "log transformed broadband")

# Add a reference line
qqline(data_2022$sqrt_broadband, col = "steelblue", lwd = 2)
```

The histogram of the square root-transformed broadband values appears more evenly distributed across the range. Besides that, the Q-Q plot also confirms that the square root transformation brings the data closer to normality, where the points closely follow the theoretical normal line, indicating good alignment with a normal distribution.

Overall, these results make square root transformation a more appropriate approach for the 2022 broadband subscription variable.

##### Square root Transform for 2011 broadband

Because we applied a square-root transformation to the 2022 broadband subscription data, we can apply the same transformation to the 2011 broadband values for consistency. The histogram and Q-Q plot show that the square-root transformation effectively reduces skewness and moves the 2011 broadband subscription data closer to a normal distribution.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Square root transformed the broadband
data_2011 <- data_2011 %>%
  filter(broadband != 0) %>% 
  mutate(sqrt_broadband = sqrt(broadband))
```


#### Distribution of Gross Domestic Product (2022)

GDP values in 2022 shows a highly skewed distribution as shown in the histogram and boxplot below. The box plot also shows numerous statistical outliers. This suggests that GDP values in 2022 will need to be transformed before including in the regression model.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Test the skewness and distribution of the data
#Histogram of GDP in 2022. 
ggplot(data_2022,aes(x=gdp))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Gross Domestic Product (GDP) in 2022",
       x = "GDP",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
#Boxplot for GDP in 2022
ggplot(data_2022, aes(y=gdp)) + 
  geom_boxplot() + 
  labs(title = "Box plot of GDP in 2022",
       y="Count") +
  theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

##### Log Transform for 2022 GDP

After applying a log transformation to 2022 GDP values, the distribution becomes more symmetric and approximately normal. The histogram indicates reduced skewness compared to the original data. The Q-Q plot confirms this with most points falling closely along the theoretical normal line. Overall, the log transformation is effective in improving the suitability of GDP for the regression modelling.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#log transform GDP
data_2022 <- data_2022 %>%
  mutate(log_gdp = log(gdp))


#Testing the skewness of log transform broadband values
ggplot(data_2022,aes(x=log_gdp))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Log GDP in 2022",
       x = "Log Transformed Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

shapiro.test(data_2022$log_gdp)

qqnorm(data_2022$log_gdp, main = "Q-Q Plot for log transformed GDP in 2022", xlab = "Theoretical Quantiles", ylab = "log transformed GDP")

# Add a reference line
qqline(data_2022$log_gdp, col = "steelblue", lwd = 2)
```

### Distribution of GDP (2011)

The distribution of GDP in 2011 is highly right-skewed, as shown by both the histogram and the box plot. There are several extreme values appear as outliers well above the upper whisker. We will need to transform the data before including it in the model. 
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Test the skewness and distribution of the data
#Histogram of GDP in 2011. 
ggplot(data_2011,aes(x=gdp))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Gross Domestic Product (GDP) in 2011",
       x = "GDP",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
#Boxplot for GDP in 2011
ggplot(data_2011, aes(y=gdp)) + 
  geom_boxplot() + 
  labs(title = "Box plot of GDP in 2011",
       y="Count") +
  theme(
    plot.title = element_text(hjust = 0.5),
    aspect.ratio = 1.5
  )
```

Since a log transformation was successfully applied to the 2022 GDP values, the same approach will be used for the 2011 data. After applying a log transformation, the distribution of GDP in 2011 becomes much more symmetric and closer to a normal shape. The Q–Q plot also shows most points fall closely along the theoretical normal line, indicating that the transformed data approximates normality. Overall log transformation effectively reduces skewness and makes the data more suitable for modelling.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#log transform GDP
data_2011 <- data_2011 %>%
  mutate(log_gdp = log(gdp))


#Testing the skewness of log transform broadband values
ggplot(data_2011,aes(x=log_gdp))+
  geom_histogram(colour="white", fill="steelblue")+
  labs(title="Log GDP in 2011",
       x = "Log Transformed Broadband",
       y = "Frequency") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )

shapiro.test(data_2011$log_gdp)

qqnorm(data_2011$log_gdp, main = "Q-Q Plot for log transformed GDP in 2011", xlab = "Theoretical Quantiles", ylab = "log transformed GDP")

# Add a reference line
qqline(data_2011$log_gdp, col = "steelblue", lwd = 2)
```

### Standardization

We standardized our data using z-scores to ensure that all variables were equally weighted in our analysis. Standardization is the process of transforming raw values into z-scores, which express each observation relative to the mean and standard deviation of its variable. 

For each year (2011 and 2022), we calculated the mean and standard deviation of each variable. Z-scores were computed using the formula z= (x-μ)/σ, where x is the observation value, μ is the mean, and σ is the standard deviation of the variable.

This transformation produced standardized variables with a mean of 0 and standard deviation of 1, allowing for comparisons across our three variables HDI, Broadband access, and GDP.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Creating vectors with the z-scores for each of the predictors
v_means_2011 <- data_2011 %>% summarize(across(-country, mean))
v_sd_2011 <- data_2011 %>% summarize(across(-country, sd))

v_means_2022 <- data_2022 %>% summarize(across(-country, mean))
v_sd_2022 <- data_2022 %>% summarize(across(-country, sd))

# Create a dataframe with the means and sds
df_standards_2011 <-  data.frame(key=names(v_means_2011),attribute_means=unlist(v_means_2011),attribute_sd=unlist(v_sd_2011))
df_standards_2022 <-  data.frame(key=names(v_means_2022),attribute_means=unlist(v_means_2022),attribute_sd=unlist(v_sd_2022))

# Make longer versions of the 2011 and 2022 dataframes
data_2011_longer <- pivot_longer(data_2011,
                                 cols = c("broadband","hdi","gdp","sqrt_broadband","log_gdp"),
                                 names_to = "key", 
                                 values_to= "values")

data_2022_longer <- pivot_longer(data_2022,
                                 cols = c("broadband","hdi","gdp","log_broadband","sqrt_broadband","log_gdp"),
                                 names_to = "key", 
                                 values_to= "values")

# Joining the two dataframes
data_2011_longer <- data_2011_longer %>% inner_join(df_standards_2011, by = "key")
data_2022_longer <- data_2022_longer %>% inner_join(df_standards_2022, by = "key")

# Create the z-scores (value-mean)/sd
data_2011_longer <- data_2011_longer %>% mutate(z_score = (values -attribute_means)/attribute_sd)
data_2022_longer <- data_2022_longer %>% mutate(z_score = (values -attribute_means)/attribute_sd)

# Pivot back to make this easier to work with
data_2011_standardized <- data_2011_longer %>% 
  dplyr::select(country,key,z_score) %>% 
  pivot_wider(., id_cols="country", names_from ="key", values_from = "z_score")

data_2022_standardized <- data_2022_longer %>% 
  dplyr::select(country,key,z_score) %>% 
  pivot_wider(., id_cols="country", names_from ="key", values_from = "z_score")
```




# Question 1 
What is the relationship between HDI and broadband subscriptions, based on the latest available data, which is 2022.


## Descriptives and EDA
Let's peek at means and standard deviations.
```{r echo=FALSE, message=FALSE, warning=FALSE}

```

### Correlation matrix
Let's look at the correlations between the independent variables. We want there to be low correlations for no multicollinerity.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# the corrplot function requires a vector of correlations

df_wider.cor = cor(data_2022_standardized[, 2:6])

# creating a lower corrplot with numbers
corrplot(df_wider.cor,
               type="lower",
               method = "number",
               tl.pos = "lt",
               diag = TRUE,
               tl.col = "black")

```

### Plots

#### Scatterplot
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Create a scatter plot of square root broadband vs hdi of 2022
ggplot(data_2022_standardized, aes(x = sqrt_broadband, y = hdi)) +
  geom_point(color = "steelblue") +                                               
  geom_smooth(method = "lm", color = "darkred", linetype = "solid") + 
  labs(title = "Scatter Plot with Best Fitted Line of Square root Broadband vs HDI in 2022",
       x = "Square root Broadband Subscription per 100",
       y = "HDI") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Create a model for 2022 data
model_2022 <- lm(hdi ~ sqrt_broadband + log_gdp, data = data_2022_standardized)
summary(model_2022)
```

# Question 2
Are there countries that significantly deviate from this relationship between HDI and broadband subscription rate?

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
data_2022_standardized <- na.omit(data_2022_standardized) %>%
  mutate(
    fitted_hdi = fitted(model_2022,),
    residuals = resid(model_2022),
    std_resid = rstandard(model_2022)
  )

outliers_2022 <- data_2022_standardized %>%
  filter(abs(std_resid) > 3)

outliers_2022
```
Our outliers in 2022 are Kiribati and Mali

# Question 3
How has broadband access by country changed between 2011, when the UN declaration was announced, and 2022? 

## Descriptives and EDA


### Plots

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
# Scatterplots by variable - using non-transformed data

merged_data  %>% filter(year==c('2011','2022')) %>% ggplot(aes(y=broadband)) +
    geom_boxplot() +
    facet_wrap(~year, scales = 'free', axis.labels= 'all_y') 
```


## T-test

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
result <- t.test(data_2011$broadband,data_2022$broadband)
result$conf.int

bb_long <- bind_rows(data_2011, data_2022) %>%
  mutate(
    year = factor(year, levels = c("2011", "2022"))
  )

null_dist <- bb_long %>%
  specify(broadband ~ year) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("2022", "2011"))

ci <- null_dist %>%
  get_ci()
ci

null_dist %>%
  visualize() +
  shade_ci(endpoints = ci)
```

## Wilcoxin-test

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
result <- wilcox.test(data_2011$broadband, data_2022$broadband)
result
result$conf.int

bb_long <- bind_rows(data_2011, data_2022) %>%
  mutate(
    year = factor(year, levels = c("2011", "2022"))
  )


null_dist <- bb_long %>%
  specify(broadband ~ year) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in medians", order = c("2022", "2011"))


ci <- null_dist %>%
  get_ci()
ci


null_dist %>%
  visualize() +
  shade_ci(endpoints = ci)

```

#### Scatterplot
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Create a scatter plot of square root broadband vs hdi of 2011
ggplot(data_2011_standardized, aes(x = sqrt_broadband, y = hdi)) +
  geom_point(color = "steelblue") +
  geom_smooth(method = "lm", color = "darkred", linetype = "solid") +
  labs(title = "Scatter Plot with Line of Best Fit of Square root Broadband vs HDI in 2011",
       x = "Square root Broadband Subscription per 100",
       y = "HDI") +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
```
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
#Create a model for 2011 data
model_2011 <- lm(hdi ~ sqrt_broadband + log_gdp, data=data_2011_standardized)
summary(model_2011)
```

##Outlier country in 2011
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
data_2011_standardized <- na.omit(data_2011_standardized) %>%
  mutate(
    fitted_hdi = fitted(model_2011),
    residuals = resid(model_2011),
    std_resid = rstandard(model_2011)
  )

outliers_2011 <- data_2011_standardized %>%
  filter(abs(std_resid) > 3)

outliers_2011
```
Our outlier is 2011 is Cuba


# Question ??


## Create a multi regression with gdp as the control variable
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
multi_reg <- lm (hdi ~ sqrt_broadband + log_gdp, data = data_2022_standardized)

summary(multi_reg)
```

## Checking assumptions

### Lack of Multicollinearity
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
vif(multi_reg)
```
The variance inflation factors are 4.01 for sqrt_broadband and 4.01 for log_gdp. This indicates that there is not a strong linear relationship between these factors.  

### Independence
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
dwtest(multi_reg)
```
?? 

### Normaility of residuals
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
plot(multi_reg, which = 1)

res_model <- residuals(multi_reg)
shapiro.test(res_model)
plot(multi_reg, which = 2)

pred_model <- fitted(multi_reg)
plot(pred_model, res_model,
     xlab = "Predicted Values (Fitted)",
     ylab = "Residuals",
     main = "Residuals vs Predicted Values",
     col = "steelblue") +
abline(h = 0, col = "red", lwd = 2)

```
#### Homoscedascity
Next, let's look for the independence of the residuals.
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align='center'}
res_model <- residuals(multi_reg)
shapiro.test(res_model)
plot(multi_reg, which = 2)
```


# 6. Results and Interpretation {#sec-results}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE

# 7. Discussions {#sec-discussion}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. In egestas lobortis porta. Phasellus tincidunt metus sed mollis imperdiet. Aliquam blandit nibh in fermentum consequat. Fusce blandit magna quis nulla ornare, non mattis enim tempor. Nulla et odio dui. Nunc ut elit venenatis, porttitor dui et, placerat tortor. Sed aliquet sodales magna, sit amet porta odio tempor in. CHANGE THIS OF COURSE

\newpage
# Appendix {#sec-appendix}

## Code

The report was created using *`R`* [@R] and *`R Studio`* [@r_studio] with *`R Markdown`* [@r_markdown]. The main library utilized for this purpose is *`Tidyverse`* [@tidyverse]. Its used sub-packages include *`dplyr`* [@dplyr] to enable query-like syntax, and *`ggplot`* [@ggplot] to create graphs and charts. Other packages and tools include *`janitor`* [@janitor], *`knitr`* [@knitr], *`kableExtra`* [@kableExtra], and *`scales`* [@scales].

\newpage
# References